<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign up</title>
    <link rel="stylesheet" href="..\css\signup.css">
    <link rel="icon" type="image/x-icon" href="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse1.mm.bing.net%2Fth%3Fid%3DOIP.2_ZX4zBjAdgYkRSsxGlGtgHaHa%26pid%3DApi&f=1&ipt=52f73723b0dd79f8690684ab26494ba9ebe579902dfee63a7bbe2f40fbbe5f08&ipo=images">
</head>
<body>
  <script src="https://kit.fontawesome.com/3bafc14110.js" crossorigin="anonymous"></script>
  <script
  type="module"
  src="https://cdn.jsdelivr.net/npm/@bufferhead/nightowl@0.0.14/dist/nightowl.js"
></script>
<main>
  <nav class="containter" style="position: sticky; top: 0; height: 60px;" class="space"><a href="index.html" class="navanax"> <i class="fa-solid fa-house"></i>Home page</a>
    <!-- <a href="shop.html" class="navanax"> <i class="fa-solid fa-shop"></i>Shop page</a>
    <a href="shop2.html" class="navanax"><i class="fa-solid fa-shop"></i>Shop Page 2</a>
    <a href="" class="navanax"><i class="fa-solid fa-shop"></i>Shop Page 3</a> -->
    <a href="signup.html" class="navanax"><i class="fa-solid fa-user-plus"></i>Sign up</a>
    <a href="login.html" class="navanax"><i class="fa-solid fa-right-to-bracket"></i>Login</a>
    </nav>
  <div class="box"> <div class="border">
    <div class="title" style="width: 200px;"><h1>Sign up</h1></div> <br>
            <input type="email" id="email" placeholder="email"> <br> <br>
            <input type="password" id="password" placeholder="password"> <br> <br>
            <input type="password" id="repassword" placeholder="retype your password"> <br> <br>
            <input type="text" id="username" placeholder="username"> <br> <br>
            <button id="sign" style="height: 50px; width: 200px;  background-color:skyblue; border-color: skyblue; border-radius: 12px;"><h1>Sign up</h1></button> 
        </div> <br> </div>


        <footer id="bottom">  
        <div class="nava">Random piece of text for a "footer" </div>
        <div class="nava"> Blah blah blah</div>
        <a class="nava" target="_blank" style="float: left; text-decoration: none;"  href="https://github.com/UnionofSovietSocialistRepublics"><i class="fa-brands fa-github"></i> Made by Horizon</a>
      </footer></main>
</body>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
  import { getDatabase, set, ref} from "https://www.gstatic.com/firebasejs/9.9.2/firebase-database.js";
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-auth.js";;
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCzc5Z8XCGkLAnp1x_wOpOE25pBHjfACPc",
    authDomain: "auth-a73a8.firebaseapp.com",
    databaseURL: "https://auth-a73a8-default-rtdb.firebaseio.com",
    projectId: "auth-a73a8",
    storageBucket: "auth-a73a8.appspot.com",
    messagingSenderId: "20002627143",
    appId: "1:20002627143:web:63c05bd9ed4504f4e41b62"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app)
  const auth = getAuth()

  sign.addEventListener('click',(e) => {
    
      var email = document.getElementById('email').value;
      var check = document.getElementById('password').value;
      var password = document.getElementById('repassword').value;
      var username = document.getElementById('username').value;
      console.log(email," ",password)
      switch(username.length){
        case 0:
          alert("Your username is empty!")
          return;
        default:
      if (password === check) {
      createUserWithEmailAndPassword(auth, email, password)
      .then((userCredential) => {
      // Signed up 
      alert("Sign up suscessful")
      setTimeout(Teleportation, 5000)
      const user = userCredential.user;
      set(ref(database, 'users/' + user.uid),{
        username: username,
        email: email
      })
      function Teleportation() {
        window.location.href = 'login.html';
      }
      })
      .catch((error) => {
      const errorCode = error.code;
      const errorMessage = error.message;
      alert(errorMessage)
      // ..
});
      }else {
        alert("password/retype password field does not have the same value!")
      }
  }
  })
</script> 
</html>